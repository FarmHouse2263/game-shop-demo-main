<!-- HTML Template -->
<div class="cart-page">
  <header class="cart-header">
    <div class="header-content">
      <h1>ตะกร้าสินค้า</h1>
      <div class="profile-section">
        <span class="profile-label">คลังเกม</span>
        <div class="profile-avatar" (click)="goToProfile()">
          <svg viewBox="0 0 24 24">
            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"></path>
          </svg>
        </div>
      </div>
    </div>
  </header>

  <main class="cart-main">
    <div class="cart-container" *ngIf="cart.length > 0; else emptyCart">
      <div class="cart-items">
        <div class="cart-item" *ngFor="let item of cart">
          <img class="game-image" [src]="item.imageUrl" [alt]="item.title">
          <div class="game-info">
            <h3>{{ item.title }}</h3>
            <p class="category">ประเภท: {{ item.category }}</p>
            <p class="date">วันที่วางขาย: {{ item.createdAt | date:'d MMMM yyyy':'':'th' }}</p>
          </div>
          <div class="price-section">
            <span class="price">{{ item.price }} บาท</span>
            <button class="remove-btn" (click)="removeItem(item.id)">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
              </svg>
              ลบ
            </button>
          </div>
        </div>
      </div>

      <div class="summary-card">
        <h2>สรุปค่าสั่งซื้อ</h2>
        <div class="summary-row">
          <span>ยอดรวม</span>
          <span class="amount">{{ getSubtotal() }} บาท</span>
        </div>
        <div class="summary-row">
          <span>ส่วนลด</span>
          <span class="amount discount">{{ getDiscount() }} บาท</span>
        </div>
        <div class="summary-divider"></div>
        <div class="summary-row total">
          <span>รวมทั้งหมด</span>
          <span class="amount">{{ getTotal() }} บาท</span>
        </div>
        <button class="checkout-btn" (click)="checkout()">
          ดำเนินการชำระเงิน
        </button>
      </div>
    </div>

    <ng-template #emptyCart="">
      <div class="empty-cart">
        <div class="empty-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
        </div>
        <h2>ตะกร้าสินค้าว่างเปล่า</h2>
        <p>คุณยังไม่มีสินค้าในตะกร้า</p>
        <button class="browse-btn" (click)="goToShop()">เริ่มเลือกซื้อเกม</button>
      </div>
    </ng-template>
  </main>
</div>